{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <title>Coding Test</title>
  </head>
  <body>
    <header>
      <h2>Python Test</h2>
    </header>
    <div class="test-dashboard">
      <section class="question">
        <div class="question-header">
          <h2>Question</h2>
        </div>
      </section>
      <section class="code">
        <div class="code-header">
          <h2>Code</h2>
        </div>
        <div class="code-container">
          <textarea class="code-area" name="code"></textarea>
        </div>
      </section>
    </div>

    <script>
      document
        .getElementById("code-area")
        .addEventListener("input", function (event) {
          if (event.inputType === "insertText" && event.data === "\n") {
            event.preventDefault();

            var textarea = event.target;
            var cursorPosition = textarea.selectionStart;

            // Get the text before and after the cursor
            var textBeforeCursor = textarea.value.substring(0, cursorPosition);
            var textAfterCursor = textarea.value.substring(cursorPosition);

            // Find the indentation of the current line
            var lineStart = textBeforeCursor.lastIndexOf("\n") + 1;
            var indentation = textBeforeCursor
              .substring(lineStart)
              .match(/^\s*/)[0];

            // Insert newline and indentation
            textarea.value =
              textBeforeCursor + "\n" + indentation + textAfterCursor;

            // Move the cursor to the correct position
            textarea.setSelectionRange(
              cursorPosition + indentation.length + 1,
              cursorPosition + indentation.length + 1
            );
          }
        });
    </script>
  </body>
</html>
